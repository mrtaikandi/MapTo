using AutoMapper;
using MappingLibrariesBenchmark.Mappings;
using MappingLibrariesBenchmark.Models;

namespace MappingLibrariesBenchmark.Scenarios;

[SimpleJob(RunStrategy.Throughput)]
[MemoryDiagnoser]
[KeepBenchmarkFiles(false)]
[GroupBenchmarksBy(BenchmarkLogicalGroupRule.ByMethod)]
[Orderer(SummaryOrderPolicy.FastestToSlowest)]
public class BenchmarkMappingLibraries
{
    private readonly IMapper _autoMapper;
    private readonly MapperlyMappings _mapperlyMappings;
    private readonly SpotifyAlbumDto _spotifyAlbumDto;

    public BenchmarkMappingLibraries()
    {
        var json = File.ReadAllText("Data\\spotifyAlbum.json");

        _spotifyAlbumDto = SpotifyAlbumDto.FromJson(json);
        _autoMapper = AutomapperMappings.Configure();
        TinyMapperMappings.Configure();
        ExpressMapperMappings.Configure();
        _mapperlyMappings = MapperlyMappings.Configure();
    }

    [Benchmark]
    public SpotifyAlbum MapTo()
    {
        return _spotifyAlbumDto.MapToSpotifyAlbum();
    }

    [Benchmark]
    public SpotifyAlbum Mapperly()
    {
        return _mapperlyMappings.Map(_spotifyAlbumDto);
    }

    // [Benchmark]
    // public void AgileMapper()
    // {
    //     AgileObjects.AgileMapper.Mapper.Map(_spotifyAlbumDto).ToANew<SpotifyAlbum>();
    // }
    //
    // [Benchmark]
    // public void AutoMapper()
    // {
    //     _autoMapper.Map<SpotifyAlbum>(_spotifyAlbumDto);
    // }
    //
    // [Benchmark]
    // public void ExpressMapper()
    // {
    //     Mapper.Map<SpotifyAlbumDto, SpotifyAlbum>(_spotifyAlbumDto);
    // }
    //
    // [Benchmark]
    // public void ManualMapping()
    // {
    //     // Generated by MappingGenerator
    //     _spotifyAlbumDto.Map();
    // }
    //
    // [Benchmark]
    // public void Mapster()
    // {
    //     _spotifyAlbumDto.Adapt<SpotifyAlbum>();
    // }
    //
    // [Benchmark]
    // public void TinyMapper()
    // {
    //     Nelibur.ObjectMapper.TinyMapper.Map<SpotifyAlbum>(_spotifyAlbumDto);
    // }
}